function dcdlts = lts_pd(q,Lmo,lts,fmo,phi,mtScal,a,afactor)
lambda = 0.15;

%FCR
S(1) = - fmo(1)*mtScal(1)*(1 - (Lmo(1)^2*sin(phi(1))^2)/(Lmo(1)^2*sin(phi(1))^2 + (lts(1) - mtScal(1)*((1423*cos((1937*q)/5000))/100000 - (1927*sin((1937*q)/5000))/50000 + 1491/5000))^2))^(1/2)*((3732599*cos((1937*q)/5000))/250000000 + (2756351*sin((1937*q)/5000))/500000000)*((175921860444160*exp((10*(Lmo(1)^2*sin(phi(1))^2 + (lts(1) - mtScal(1)*((1423*cos((1937*q)/5000))/100000 - (1927*sin((1937*q)/5000))/50000 + 1491/5000))^2)^(1/2))/Lmo(1) - 10)*(lts(1) - mtScal(1)*((1423*cos((1937*q)/5000))/100000 - (1927*sin((1937*q)/5000))/50000 + 1491/5000)))/(5221823812744079*Lmo(1)*(Lmo(1)^2*sin(phi(1))^2 + (lts(1) - mtScal(1)*((1423*cos((1937*q)/5000))/100000 - (1927*sin((1937*q)/5000))/50000 + 1491/5000))^2)^(1/2)) - (4*exp(-((4*(Lmo(1)^2*sin(phi(1))^2 + (lts(1) - mtScal(1)*((1423*cos((1937*q)/5000))/100000 - (1927*sin((1937*q)/5000))/50000 + 1491/5000))^2)^(1/2))/(Lmo(1)*(lambda*((exp(a(1)*afactor) - 1)/(exp(afactor) - 1) - 1) - 1)) + 4)^2)*(exp(a(1)*afactor) - 1)*((4*(Lmo(1)^2*sin(phi(1))^2 + (lts(1) - mtScal(1)*((1423*cos((1937*q)/5000))/100000 - (1927*sin((1937*q)/5000))/50000 + 1491/5000))^2)^(1/2))/(Lmo(1)*(lambda*((exp(a(1)*afactor) - 1)/(exp(afactor) - 1) - 1) - 1)) + 4)*(lts(1) - mtScal(1)*((1423*cos((1937*q)/5000))/100000 - (1927*sin((1937*q)/5000))/50000 + 1491/5000)))/(Lmo(1)*(exp(afactor) - 1)*(lambda*((exp(a(1)*afactor) - 1)/(exp(afactor) - 1) - 1) - 1)*(Lmo(1)^2*sin(phi(1))^2 + (lts(1) - mtScal(1)*((1423*cos((1937*q)/5000))/100000 - (1927*sin((1937*q)/5000))/50000 + 1491/5000))^2)^(1/2))) - (Lmo(1)^2*fmo(1)*mtScal(1)*sin(phi(1))^2*((3732599*cos((1937*q)/5000))/250000000 + (2756351*sin((1937*q)/5000))/500000000)*((35184372088832*exp((10*(Lmo(1)^2*sin(phi(1))^2 + (lts(1) - mtScal(1)*((1423*cos((1937*q)/5000))/100000 - (1927*sin((1937*q)/5000))/50000 + 1491/5000))^2)^(1/2))/Lmo(1) - 10))/5221823812744079 + (exp(-((4*(Lmo(1)^2*sin(phi(1))^2 + (lts(1) - mtScal(1)*((1423*cos((1937*q)/5000))/100000 - (1927*sin((1937*q)/5000))/50000 + 1491/5000))^2)^(1/2))/(Lmo(1)*(lambda*((exp(a(1)*afactor) - 1)/(exp(afactor) - 1) - 1) - 1)) + 4)^2)*(exp(a(1)*afactor) - 1))/(exp(afactor) - 1))*(lts(1) - mtScal(1)*((1423*cos((1937*q)/5000))/100000 - (1927*sin((1937*q)/5000))/50000 + 1491/5000)))/(2*(Lmo(1)^2*sin(phi(1))^2 + (lts(1) - mtScal(1)*((1423*cos((1937*q)/5000))/100000 - (1927*sin((1937*q)/5000))/50000 + 1491/5000))^2)^2*(1 - (Lmo(1)^2*sin(phi(1))^2)/(Lmo(1)^2*sin(phi(1))^2 + (lts(1) - mtScal(1)*((1423*cos((1937*q)/5000))/100000 - (1927*sin((1937*q)/5000))/50000 + 1491/5000))^2))^(1/2));

%FCU
S(2) = - fmo(2)*mtScal(2)*(1 - (Lmo(2)^2*sin(phi(2))^2)/(Lmo(2)^2*sin(phi(2))^2 + (lts(2) - mtScal(2)*((2491*cos((1227*q)/5000))/50000 - (1219*sin((1227*q)/5000))/20000 + 657/2500))^2))^(1/2)*((1495713*cos((49*q)/200))/100000000 + (3056457*sin((1227*q)/5000))/250000000)*((175921860444160*exp((10*(Lmo(2)^2*sin(phi(2))^2 + (lts(2) - mtScal(2)*((2491*cos((1227*q)/5000))/50000 - (1219*sin((1227*q)/5000))/20000 + 657/2500))^2)^(1/2))/Lmo(2) - 10)*(lts(2) - mtScal(2)*((2491*cos((1227*q)/5000))/50000 - (1219*sin((1227*q)/5000))/20000 + 657/2500)))/(5221823812744079*Lmo(2)*(Lmo(2)^2*sin(phi(2))^2 + (lts(2) - mtScal(2)*((2491*cos((1227*q)/5000))/50000 - (1219*sin((1227*q)/5000))/20000 + 657/2500))^2)^(1/2)) - (4*exp(-((4*(Lmo(2)^2*sin(phi(2))^2 + (lts(2) - mtScal(2)*((2491*cos((1227*q)/5000))/50000 - (1219*sin((1227*q)/5000))/20000 + 657/2500))^2)^(1/2))/(Lmo(2)*(lambda*((exp(a(2)*afactor) - 1)/(exp(afactor) - 1) - 1) - 1)) + 4)^2)*(exp(a(2)*afactor) - 1)*((4*(Lmo(2)^2*sin(phi(2))^2 + (lts(2) - mtScal(2)*((2491*cos((1227*q)/5000))/50000 - (1219*sin((1227*q)/5000))/20000 + 657/2500))^2)^(1/2))/(Lmo(2)*(lambda*((exp(a(2)*afactor) - 1)/(exp(afactor) - 1) - 1) - 1)) + 4)*(lts(2) - mtScal(2)*((2491*cos((1227*q)/5000))/50000 - (1219*sin((1227*q)/5000))/20000 + 657/2500)))/(Lmo(2)*(exp(afactor) - 1)*(lambda*((exp(a(2)*afactor) - 1)/(exp(afactor) - 1) - 1) - 1)*(Lmo(2)^2*sin(phi(2))^2 + (lts(2) - mtScal(2)*((2491*cos((1227*q)/5000))/50000 - (1219*sin((1227*q)/5000))/20000 + 657/2500))^2)^(1/2))) - (Lmo(2)^2*fmo(2)*mtScal(2)*sin(phi(2))^2*((1495713*cos((49*q)/200))/100000000 + (3056457*sin((1227*q)/5000))/250000000)*((35184372088832*exp((10*(Lmo(2)^2*sin(phi(2))^2 + (lts(2) - mtScal(2)*((2491*cos((1227*q)/5000))/50000 - (1219*sin((1227*q)/5000))/20000 + 657/2500))^2)^(1/2))/Lmo(2) - 10))/5221823812744079 + (exp(-((4*(Lmo(2)^2*sin(phi(2))^2 + (lts(2) - mtScal(2)*((2491*cos((1227*q)/5000))/50000 - (1219*sin((1227*q)/5000))/20000 + 657/2500))^2)^(1/2))/(Lmo(2)*(lambda*((exp(a(2)*afactor) - 1)/(exp(afactor) - 1) - 1) - 1)) + 4)^2)*(exp(a(2)*afactor) - 1))/(exp(afactor) - 1))*(lts(2) - mtScal(2)*((2491*cos((1227*q)/5000))/50000 - (1219*sin((1227*q)/5000))/20000 + 657/2500)))/(2*(Lmo(2)^2*sin(phi(2))^2 + (lts(2) - mtScal(2)*((2491*cos((1227*q)/5000))/50000 - (1219*sin((1227*q)/5000))/20000 + 657/2500))^2)^2*(1 - (Lmo(2)^2*sin(phi(2))^2)/(Lmo(2)^2*sin(phi(2))^2 + (lts(2) - mtScal(2)*((2491*cos((1227*q)/5000))/50000 - (1219*sin((1227*q)/5000))/20000 + 657/2500))^2))^(1/2));

%ECRL
S(3) = fmo(3)*mtScal(3)*((10071157*cos((7499*q)/100000))/1000000000 - (34952839*sin((7499*q)/100000))/1000000000)*(1 - (Lmo(3)^2*sin(phi(3))^2)/(Lmo(3)^2*sin(phi(3))^2 + (lts(3) - mtScal(3)*((4661*cos((7499*q)/100000))/10000 + (1343*sin((7499*q)/100000))/10000 - 1317/10000))^2))^(1/2)*((175921860444160*exp((10*(Lmo(3)^2*sin(phi(3))^2 + (lts(3) - mtScal(3)*((4661*cos((7499*q)/100000))/10000 + (1343*sin((7499*q)/100000))/10000 - 1317/10000))^2)^(1/2))/Lmo(3) - 10)*(lts(3) - mtScal(3)*((4661*cos((7499*q)/100000))/10000 + (1343*sin((7499*q)/100000))/10000 - 1317/10000)))/(5221823812744079*Lmo(3)*(Lmo(3)^2*sin(phi(3))^2 + (lts(3) - mtScal(3)*((4661*cos((7499*q)/100000))/10000 + (1343*sin((7499*q)/100000))/10000 - 1317/10000))^2)^(1/2)) - (4*exp(-((4*(Lmo(3)^2*sin(phi(3))^2 + (lts(3) - mtScal(3)*((4661*cos((7499*q)/100000))/10000 + (1343*sin((7499*q)/100000))/10000 - 1317/10000))^2)^(1/2))/(Lmo(3)*(lambda*((exp(a(3)*afactor) - 1)/(exp(afactor) - 1) - 1) - 1)) + 4)^2)*(exp(a(3)*afactor) - 1)*((4*(Lmo(3)^2*sin(phi(3))^2 + (lts(3) - mtScal(3)*((4661*cos((7499*q)/100000))/10000 + (1343*sin((7499*q)/100000))/10000 - 1317/10000))^2)^(1/2))/(Lmo(3)*(lambda*((exp(a(3)*afactor) - 1)/(exp(afactor) - 1) - 1) - 1)) + 4)*(lts(3) - mtScal(3)*((4661*cos((7499*q)/100000))/10000 + (1343*sin((7499*q)/100000))/10000 - 1317/10000)))/(Lmo(3)*(exp(afactor) - 1)*(lambda*((exp(a(3)*afactor) - 1)/(exp(afactor) - 1) - 1) - 1)*(Lmo(3)^2*sin(phi(3))^2 + (lts(3) - mtScal(3)*((4661*cos((7499*q)/100000))/10000 + (1343*sin((7499*q)/100000))/10000 - 1317/10000))^2)^(1/2))) + (Lmo(3)^2*fmo(3)*mtScal(3)*sin(phi(3))^2*((10071157*cos((7499*q)/100000))/1000000000 - (34952839*sin((7499*q)/100000))/1000000000)*((35184372088832*exp((10*(Lmo(3)^2*sin(phi(3))^2 + (lts(3) - mtScal(3)*((4661*cos((7499*q)/100000))/10000 + (1343*sin((7499*q)/100000))/10000 - 1317/10000))^2)^(1/2))/Lmo(3) - 10))/5221823812744079 + (exp(-((4*(Lmo(3)^2*sin(phi(3))^2 + (lts(3) - mtScal(3)*((4661*cos((7499*q)/100000))/10000 + (1343*sin((7499*q)/100000))/10000 - 1317/10000))^2)^(1/2))/(Lmo(3)*(lambda*((exp(a(3)*afactor) - 1)/(exp(afactor) - 1) - 1) - 1)) + 4)^2)*(exp(a(3)*afactor) - 1))/(exp(afactor) - 1))*(lts(3) - mtScal(3)*((4661*cos((7499*q)/100000))/10000 + (1343*sin((7499*q)/100000))/10000 - 1317/10000)))/(2*(Lmo(3)^2*sin(phi(3))^2 + (lts(3) - mtScal(3)*((4661*cos((7499*q)/100000))/10000 + (1343*sin((7499*q)/100000))/10000 - 1317/10000))^2)^2*(1 - (Lmo(3)^2*sin(phi(3))^2)/(Lmo(3)^2*sin(phi(3))^2 + (lts(3) - mtScal(3)*((4661*cos((7499*q)/100000))/10000 + (1343*sin((7499*q)/100000))/10000 - 1317/10000))^2))^(1/2));

%ECRB
S(4) = fmo(4)*mtScal(4)*(1 - (Lmo(4)^2*sin(phi(4))^2)/(Lmo(4)^2*sin(phi(4))^2 + (lts(4) - mtScal(4)*((4893*cos((1069*q)/5000))/100000 + (311*sin((1069*q)/5000))/5000 + 2371/10000))^2))^(1/2)*((332459*cos((1069*q)/5000))/25000000 - (5230617*sin((1069*q)/5000))/500000000)*((175921860444160*exp((10*(Lmo(4)^2*sin(phi(4))^2 + (lts(4) - mtScal(4)*((4893*cos((1069*q)/5000))/100000 + (311*sin((1069*q)/5000))/5000 + 2371/10000))^2)^(1/2))/Lmo(4) - 10)*(lts(4) - mtScal(4)*((4893*cos((1069*q)/5000))/100000 + (311*sin((1069*q)/5000))/5000 + 2371/10000)))/(5221823812744079*Lmo(4)*(Lmo(4)^2*sin(phi(4))^2 + (lts(4) - mtScal(4)*((4893*cos((1069*q)/5000))/100000 + (311*sin((1069*q)/5000))/5000 + 2371/10000))^2)^(1/2)) - (4*exp(-((4*(Lmo(4)^2*sin(phi(4))^2 + (lts(4) - mtScal(4)*((4893*cos((1069*q)/5000))/100000 + (311*sin((1069*q)/5000))/5000 + 2371/10000))^2)^(1/2))/(Lmo(4)*(lambda*((exp(a(4)*afactor) - 1)/(exp(afactor) - 1) - 1) - 1)) + 4)^2)*(exp(a(4)*afactor) - 1)*((4*(Lmo(4)^2*sin(phi(4))^2 + (lts(4) - mtScal(4)*((4893*cos((1069*q)/5000))/100000 + (311*sin((1069*q)/5000))/5000 + 2371/10000))^2)^(1/2))/(Lmo(4)*(lambda*((exp(a(4)*afactor) - 1)/(exp(afactor) - 1) - 1) - 1)) + 4)*(lts(4) - mtScal(4)*((4893*cos((1069*q)/5000))/100000 + (311*sin((1069*q)/5000))/5000 + 2371/10000)))/(Lmo(4)*(exp(afactor) - 1)*(lambda*((exp(a(4)*afactor) - 1)/(exp(afactor) - 1) - 1) - 1)*(Lmo(4)^2*sin(phi(4))^2 + (lts(4) - mtScal(4)*((4893*cos((1069*q)/5000))/100000 + (311*sin((1069*q)/5000))/5000 + 2371/10000))^2)^(1/2))) + (Lmo(4)^2*fmo(4)*mtScal(4)*sin(phi(4))^2*((332459*cos((1069*q)/5000))/25000000 - (5230617*sin((1069*q)/5000))/500000000)*((35184372088832*exp((10*(Lmo(4)^2*sin(phi(4))^2 + (lts(4) - mtScal(4)*((4893*cos((1069*q)/5000))/100000 + (311*sin((1069*q)/5000))/5000 + 2371/10000))^2)^(1/2))/Lmo(4) - 10))/5221823812744079 + (exp(-((4*(Lmo(4)^2*sin(phi(4))^2 + (lts(4) - mtScal(4)*((4893*cos((1069*q)/5000))/100000 + (311*sin((1069*q)/5000))/5000 + 2371/10000))^2)^(1/2))/(Lmo(4)*(lambda*((exp(a(4)*afactor) - 1)/(exp(afactor) - 1) - 1) - 1)) + 4)^2)*(exp(a(4)*afactor) - 1))/(exp(afactor) - 1))*(lts(4) - mtScal(4)*((4893*cos((1069*q)/5000))/100000 + (311*sin((1069*q)/5000))/5000 + 2371/10000)))/(2*(Lmo(4)^2*sin(phi(4))^2 + (lts(4) - mtScal(4)*((4893*cos((1069*q)/5000))/100000 + (311*sin((1069*q)/5000))/5000 + 2371/10000))^2)^2*(1 - (Lmo(4)^2*sin(phi(4))^2)/(Lmo(4)^2*sin(phi(4))^2 + (lts(4) - mtScal(4)*((4893*cos((1069*q)/5000))/100000 + (311*sin((1069*q)/5000))/5000 + 2371/10000))^2))^(1/2));

%ECU
S(5) = fmo(5)*mtScal(5)*((175921860444160*exp((10*(Lmo(5)^2*sin(phi(5))^2 + (lts(5) - mtScal(5)*((3160734304879671*sin((1213*q)/1000))/576460752303423488 - (646097211181677*cos((1213*q)/1000))/4611686018427387904 + 581/2000))^2)^(1/2))/Lmo(5) - 10)*(lts(5) - mtScal(5)*((3160734304879671*sin((1213*q)/1000))/576460752303423488 - (646097211181677*cos((1213*q)/1000))/4611686018427387904 + 581/2000)))/(5221823812744079*Lmo(5)*(Lmo(5)^2*sin(phi(5))^2 + (lts(5) - mtScal(5)*((3160734304879671*sin((1213*q)/1000))/576460752303423488 - (646097211181677*cos((1213*q)/1000))/4611686018427387904 + 581/2000))^2)^(1/2)) - (4*exp(-((4*(Lmo(5)^2*sin(phi(5))^2 + (lts(5) - mtScal(5)*((3160734304879671*sin((1213*q)/1000))/576460752303423488 - (646097211181677*cos((1213*q)/1000))/4611686018427387904 + 581/2000))^2)^(1/2))/(Lmo(5)*(lambda*((exp(a(5)*afactor) - 1)/(exp(afactor) - 1) - 1) - 1)) + 4)^2)*(exp(a(5)*afactor) - 1)*((4*(Lmo(5)^2*sin(phi(5))^2 + (lts(5) - mtScal(5)*((3160734304879671*sin((1213*q)/1000))/576460752303423488 - (646097211181677*cos((1213*q)/1000))/4611686018427387904 + 581/2000))^2)^(1/2))/(Lmo(5)*(lambda*((exp(a(5)*afactor) - 1)/(exp(afactor) - 1) - 1) - 1)) + 4)*(lts(5) - mtScal(5)*((3160734304879671*sin((1213*q)/1000))/576460752303423488 - (646097211181677*cos((1213*q)/1000))/4611686018427387904 + 581/2000)))/(Lmo(5)*(exp(afactor) - 1)*(lambda*((exp(a(5)*afactor) - 1)/(exp(afactor) - 1) - 1) - 1)*(Lmo(5)^2*sin(phi(5))^2 + (lts(5) - mtScal(5)*((3160734304879671*sin((1213*q)/1000))/576460752303423488 - (646097211181677*cos((1213*q)/1000))/4611686018427387904 + 581/2000))^2)^(1/2)))*(1 - (Lmo(5)^2*sin(phi(5))^2)/(Lmo(5)^2*sin(phi(5))^2 + (lts(5) - mtScal(5)*((3160734304879671*sin((1213*q)/1000))/576460752303423488 - (646097211181677*cos((1213*q)/1000))/4611686018427387904 + 581/2000))^2))^(1/2)*((1872056011630391*cos((1213*q)/1000))/281474976710656000 + (6122780602838861*sin((1213*q)/1000))/36028797018963968000) + (Lmo(5)^2*fmo(5)*mtScal(5)*sin(phi(5))^2*((1872056011630391*cos((1213*q)/1000))/281474976710656000 + (6122780602838861*sin((1213*q)/1000))/36028797018963968000)*((35184372088832*exp((10*(Lmo(5)^2*sin(phi(5))^2 + (lts(5) - mtScal(5)*((3160734304879671*sin((1213*q)/1000))/576460752303423488 - (646097211181677*cos((1213*q)/1000))/4611686018427387904 + 581/2000))^2)^(1/2))/Lmo(5) - 10))/5221823812744079 + (exp(-((4*(Lmo(5)^2*sin(phi(5))^2 + (lts(5) - mtScal(5)*((3160734304879671*sin((1213*q)/1000))/576460752303423488 - (646097211181677*cos((1213*q)/1000))/4611686018427387904 + 581/2000))^2)^(1/2))/(Lmo(5)*(lambda*((exp(a(5)*afactor) - 1)/(exp(afactor) - 1) - 1) - 1)) + 4)^2)*(exp(a(5)*afactor) - 1))/(exp(afactor) - 1))*(lts(5) - mtScal(5)*((3160734304879671*sin((1213*q)/1000))/576460752303423488 - (646097211181677*cos((1213*q)/1000))/4611686018427387904 + 581/2000)))/(2*(Lmo(5)^2*sin(phi(5))^2 + (lts(5) - mtScal(5)*((3160734304879671*sin((1213*q)/1000))/576460752303423488 - (646097211181677*cos((1213*q)/1000))/4611686018427387904 + 581/2000))^2)^2*(1 - (Lmo(5)^2*sin(phi(5))^2)/(Lmo(5)^2*sin(phi(5))^2 + (lts(5) - mtScal(5)*((3160734304879671*sin((1213*q)/1000))/576460752303423488 - (646097211181677*cos((1213*q)/1000))/4611686018427387904 + 581/2000))^2))^(1/2));

dcdlts = S;
end